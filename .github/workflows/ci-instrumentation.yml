name: "ðŸ§ª Instrumentation Test Matrix"

on:
  workflow_call:

jobs:

  instrumentation:
    name: "${{ matrix.api }}"

    uses: TWiStErRob/github-workflows/.github/workflows/instrumentation.yml@c5544e2db24efa2e06a06deb7008b1bf7d0ff21f # v3
    with:
      android-api: ${{ matrix.api }}
      timeout-minutes: 60
      java-version: 21
      # language=bash
      script: |
        ./gradlew --no-daemon --no-configuration-cache --no-build-cache --continue --stacktrace connectedCheck :mergeAndroidReports

    permissions:
      contents: read
      checks: write
      statuses: write

    strategy:
      fail-fast: false
      matrix:
        # The API level, see https://apilevels.com/.
        api:
          - 21 # A stable version for now.
